#!/usr/bin/env python3
# An evaluate generic fake script
import os, sys, json, math, hashlib
import random

VERSION = 1


params_values = {}


def get_param_value(name, default=None):
    return next((v for k, v in params_values.items() if k.endswith("." + name)), default)

def set_random_seed():
    random.seed(get_param_value("seed", 1234))

assert len(sys.argv) == 3, "Expected argv: evaluate.py model test.data"


def phi(x):
    'Cumulative distribution function for the standard normal distribution'
    return (1.0 + math.erf(x / math.sqrt(2.0))) / 2.0

def hash_str(s):
    return hashlib.md5(s.encode()).digest()[0]

FINALIZE = {"0-1": phi, "1-0": lambda x: 1 - phi(x), "id": lambda x: x, "0-": math.exp,
            "intexp": lambda x: int(1000 * 10 ** x), "int": lambda x: int(100 * x)}


def evaluate_metric(name, typ, data):
    val = 0

    for p, v in data["params"].items():
        v = math.copysign(math.log(abs(v) + 1, 100), v)
        factor, noise, noise_period = COEFS["params"][hash_str(f"{name}:{p}")]
        val += factor * v + noise * math.cos(v / noise_period * math.pi * 2)

    for i, w in enumerate(data["work"]):
        w *= 0.33
        factor, noise, noise_period = COEFS["work"][hash_str(f"{name}:{i}")]
        val += factor * w + noise * math.sin(w / noise_period * math.pi * 2)

    return FINALIZE[typ](val)


def update_json(filename, update):
    try:
        with open(filename) as fd:
            value = json.load(fd)
    except (FileNotFoundError, json.JSONDecodeError):
        value = {}

    value.update(update)
    with open(filename, "w") as fd:
        json.dump(value, fd)


def dict_set(coll, keys, value):
    for i, key in enumerate(keys):
        if i == len(keys) - 1:
            coll[key] = value
        elif key not in coll:
            coll[key] = {}
        coll = coll[key]


def main():
    with open(sys.argv[1]) as model:
        data = json.load(model)
        data_size = os.stat(sys.argv[2]).st_size
        data["work"].append(math.log(data_size + 1))

        for filename, metrics in METRICS.items():
            update = {}
            for name, typ in metrics.items():
                dict_set(update, name.split("."), evaluate_metric(name, typ, data))
            update_json(filename, update)


# This coefficients define how params and "work" (data amount + code version) change metric values.
# To be both stable and not preconfigured for particular param/metric names we use feature hashing.
# These take some space so we place it as low as possible in out code.
METRICS = {'metrics.json': {'classifier.O8': 'int',
                  'classifier.WH': '0-',
                  'classifier.YD': '1-0',
                  'classifier.accuracy': '0-1',
                  'classifier.ae': 'id',
                  'classifier.auc': '0-1',
                  'classifier.avg_time': '0-',
                  'classifier.benchmark': 'id',
                  'classifier.distinct': 'int',
                  'classifier.entropy': 'id',
                  'classifier.errors': 'int',
                  'classifier.exp_cost': 'intexp',
                  'classifier.f1-score': '0-1',
                  'classifier.falsepos': '1-0',
                  'classifier.fullscore': '0-1',
                  'classifier.index': '0-',
                  'classifier.iq': '1-0',
                  'classifier.loss': '1-0',
                  'classifier.meanscore': '0-1',
                  'classifier.n_docs': 'intexp',
                  'classifier.non_null': '1-0',
                  'classifier.precision': '0-1',
                  'classifier.prediction_time': '0-',
                  'classifier.q5': 'intexp',
                  'classifier.qd': '0-1',
                  'classifier.recall': '0-1',
                  'classifier.size': 'intexp',
                  'classifier.time': '0-',
                  'classifier.weighted_avg': 'id',
                  'entities.O8': 'int',
                  'entities.WH': '0-',
                  'entities.YD': '0-1',
                  'entities.accuracy': '0-1',
                  'entities.ae': '0-1',
                  'entities.auc': '0-1',
                  'entities.avg_time': '0-',
                  'entities.benchmark': 'id',
                  'entities.distinct': 'int',
                  'entities.entropy': 'id',
                  'entities.errors': 'int',
                  'entities.exp_cost': 'intexp',
                  'entities.f1-score': '0-1',
                  'entities.falsepos': '1-0',
                  'entities.fullscore': '0-1',
                  'entities.index': '0-',
                  'entities.iq': '0-',
                  'entities.loss': '1-0',
                  'entities.meanscore': '0-1',
                  'entities.n_docs': 'intexp',
                  'entities.non_null': '1-0',
                  'entities.precision': '0-1',
                  'entities.prediction_time': '0-',
                  'entities.q5': 'id',
                  'entities.qd': 'intexp',
                  'entities.recall': '0-1',
                  'entities.size': 'intexp',
                  'entities.time': '0-',
                  'entities.weighted_avg': 'id',
                  'estimate.O8': 'id',
                  'estimate.WH': '0-',
                  'estimate.YD': '0-',
                  'estimate.accuracy': '0-1',
                  'estimate.ae': 'id',
                  'estimate.auc': '0-1',
                  'estimate.avg_time': '0-',
                  'estimate.benchmark': 'id',
                  'estimate.distinct': 'int',
                  'estimate.entropy': 'id',
                  'estimate.errors': 'int',
                  'estimate.f1-score': '0-1',
                  'estimate.falsepos': '1-0',
                  'estimate.fullscore': '0-1',
                  'estimate.index': '0-',
                  'estimate.iq': '0-',
                  'estimate.loss': '1-0',
                  'estimate.meanscore': '0-1',
                  'estimate.n_docs': 'intexp',
                  'estimate.non_null': '1-0',
                  'estimate.precision': '0-1',
                  'estimate.prediction_time': '0-',
                  'estimate.q5': '0-',
                  'estimate.qd': 'int',
                  'estimate.recall': '0-1',
                  'estimate.size': 'intexp',
                  'estimate.time': '0-',
                  'estimate.weighted_avg': 'id',
                  'mark.O8': 'int',
                  'mark.WH': 'intexp',
                  'mark.YD': '0-',
                  'mark.accuracy': '0-1',
                  'mark.ae': '0-',
                  'mark.auc': '0-1',
                  'mark.avg_time': '0-',
                  'mark.benchmark': 'id',
                  'mark.distinct': 'int',
                  'mark.entropy': 'id',
                  'mark.errors': 'int',
                  'mark.exp_cost': 'intexp',
                  'mark.f1-score': '0-1',
                  'mark.falsepos': '1-0',
                  'mark.fullscore': '0-1',
                  'mark.index': '0-',
                  'mark.iq': '0-1',
                  'mark.loss': '1-0',
                  'mark.meanscore': '0-1',
                  'mark.n_docs': 'intexp',
                  'mark.non_null': '1-0',
                  'mark.precision': '0-1',
                  'mark.prediction_time': '0-',
                  'mark.q5': '0-1',
                  'mark.qd': '0-',
                  'mark.recall': '0-1',
                  'mark.size': 'intexp',
                  'mark.time': '0-',
                  'mark.weighted_avg': 'id',
                  'reports.O8': 'int',
                  'reports.WH': 'id',
                  'reports.YD': '1-0',
                  'reports.accuracy': '0-1',
                  'reports.ae': 'int',
                  'reports.auc': '0-1',
                  'reports.avg_time': '0-',
                  'reports.benchmark': 'id',
                  'reports.distinct': 'int',
                  'reports.entropy': 'id',
                  'reports.errors': 'int',
                  'reports.exp_cost': 'intexp',
                  'reports.f1-score': '0-1',
                  'reports.falsepos': '1-0',
                  'reports.fullscore': '0-1',
                  'reports.index': '0-',
                  'reports.iq': 'int',
                  'reports.loss': '1-0',
                  'reports.meanscore': '0-1',
                  'reports.n_docs': 'intexp',
                  'reports.non_null': '1-0',
                  'reports.precision': '0-1',
                  'reports.prediction_time': '0-',
                  'reports.q5': '1-0',
                  'reports.qd': '1-0',
                  'reports.recall': '0-1',
                  'reports.size': 'intexp',
                  'reports.time': '0-',
                  'reports.weighted_avg': 'id',
                  'train.O8': 'id',
                  'train.WH': 'int',
                  'train.YD': 'id',
                  'train.accuracy': '0-1',
                  'train.ae': 'int',
                  'train.auc': '0-1',
                  'train.avg_time': '0-',
                  'train.benchmark': 'id',
                  'train.distinct': 'int',
                  'train.entropy': 'id',
                  'train.errors': 'int',
                  'train.exp_cost': 'intexp',
                  'train.f1-score': '0-1',
                  'train.falsepos': '1-0',
                  'train.fullscore': '0-1',
                  'train.index': '0-',
                  'train.iq': 'intexp',
                  'train.loss': '1-0',
                  'train.meanscore': '0-1',
                  'train.n_docs': 'intexp',
                  'train.non_null': '1-0',
                  'train.precision': '0-1',
                  'train.prediction_time': '0-',
                  'train.q5': '0-',
                  'train.qd': '0-',
                  'train.recall': '0-1',
                  'train.size': 'intexp',
                  'train.time': '0-',
                  'train.weighted_avg': 'id'}}
COEFS = {'params': [(0.015442700861591024, -0.0296195643722984, 2.0487959785390464),
            (0.03968770384236725, 0.021612810888439832, 1.671092120463323),
            (-0.07108687634179933, -0.025740512733216314, 1.7937209068334583),
            (-0.09441889619467997, 0.032333539121507854, 1.5642086950531002),
            (0.06364121299902264, -0.07143658077218283, 1.9629945094967194),
            (0.08502504313068149, -0.09997887097993552, 1.2439720238295138),
            (0.06834620769572083, -0.036134679444419324, 2.1678919973824335),
            (0.07325078270047536, 0.006532615470410022, 1.1316282975022336),
            (0.017324687806463318, 0.08442690010773046, 1.9075289087197878),
            (-0.08861546125841308, 0.06960333278086078, 1.052603070530526),
            (-0.021577059017727218, 0.013791268566632348, 1.9284088429927535),
            (-0.0627719483790301, 0.0786903838780105, 2.3695214327952456),
            (-0.07654447073708691, 0.00915907041785706, 1.5297825085924848),
            (0.034445007599347266, 0.09239115958798164, 1.4878181234962757),
            (0.011864143208065198, -0.03184161407605833, 1.757142148156143),
            (-0.03806541212696939, -0.07864500018302441, 1.7480178652611307),
            (-0.0063931313253310085, 0.08789350524725242, 2.6520764607180642),
            (0.05773572720506964, 0.06645309548693967, 2.162449260511333),
            (-0.061306253425035595, -0.028285580384363712, 1.6290824116981668),
            (-3.185678221970245e-05, 0.05480084487830597, 2.213209183445879),
            (-0.06531333297271444, 0.09502562720249597, 2.3406995673020905),
            (0.028095463126890763, -0.09242623722271273, 1.4828986410705216),
            (0.023443758306840354, 0.05654971063231623, 1.9525773031074791),
            (-0.07322193488228242, 0.01736563530510482, 2.3631158634879776),
            (-0.05095604780410326, -0.025486824899371693, 1.3863651490699322),
            (0.07264824736653627, 0.03744756435965951, 2.1954853035402024),
            (-0.06325212382052699, -0.07146112315257179, 2.993085149379517),
            (-0.005510509609146674, -0.04099535465507112, 2.801790430190314),
            (-0.08345282719484577, 0.07183575458860975, 1.3241381430142003),
            (-0.058228329392433054, 0.078676880337683, 1.6195974411778193),
            (0.04215797785115605, 0.08704114335561863, 2.9951568233364054),
            (-0.079315002578215, -0.019691766653612316, 2.4574570791424213),
            (0.06398017337322084, -0.020569375884078006, 2.7523842704375907),
            (0.09157198230960495, 0.0492156275320455, 2.8785040413243577),
            (0.07982739148759943, -0.06979209811733217, 1.9109293680970503),
            (0.05130334024885394, 0.06014225456347494, 2.6885980669090968),
            (0.09424588475825349, 0.039794322247401315, 1.9223752611369656),
            (0.05174538830367742, -0.0368422956438557, 1.6876776500512158),
            (-0.09971198221823484, -0.09014152345579607, 2.896692921538575),
            (-0.08449599271534845, -0.05724785821528076, 2.280710081851927),
            (0.07925887783886396, 0.0568748619187274, 1.8255952536161903),
            (0.0871889944457784, 0.009049178611210212, 1.9785757637530461),
            (0.05306217449337197, -0.07899911146688746, 1.4179539731143338),
            (0.07106551682174134, 0.06521432718948059, 2.245621396630078),
            (0.027661271983304758, -0.07731031364056398, 1.5907628881474096),
            (-0.096586074909218, 0.09193609990536183, 2.3323942973110245),
            (-0.03960973351490742, 0.051201524571723195, 1.9327016058495579),
            (0.01710640425433163, 0.09792315474172786, 2.0011543222178623),
            (-0.0950100234686146, -0.060660445313647296, 1.923838365293466),
            (-0.04769058693369437, 0.04951107234925611, 2.847077680967402),
            (-0.0974631068070377, 0.06905880129296124, 2.6146480277096154),
            (-0.012909395172540708, 0.018545754936752173, 2.010041361500198),
            (0.09547356474958571, 0.06529350220274618, 1.89004284105701),
            (0.058434246350454216, 0.028031527290429292, 2.5915256047743442),
            (0.09954757099795392, 0.07792276675546864, 1.1921874111880686),
            (-0.07320990408225021, 0.060630077869580634, 2.3358153593449513),
            (-0.09314118070693474, -0.020650853546283973, 2.043229526498215),
            (0.015448909006321052, -0.024766918386186082, 1.6776371722612033),
            (-0.026215879724436536, -0.03117496131583808, 1.9668473187236184),
            (0.044218743510826275, 0.08906885473065226, 2.5044342853744075),
            (-0.09850714476235017, -0.04089618175825607, 1.8781812223721475),
            (-0.009114041190873182, 0.05908417018916898, 2.173859953267445),
            (0.026060384978088408, -0.03392151557478139, 1.650233614141697),
            (-0.00019199066382838414, 0.08883199278647014, 1.3124370309659537),
            (0.07054782525671621, -0.028592787403442954, 1.161325163133329),
            (-0.042014135435117894, 0.09330867678181054, 2.040450399777056),
            (-0.007982241345561136, -0.08770621885299934, 1.4959079780964284),
            (-0.08837553619337402, 0.09827613138240524, 2.9655022551284658),
            (0.08537321083087945, -0.08265522876336465, 2.4747628004072366),
            (0.046199327140738655, 0.07288541871426465, 2.0578800065598233),
            (-0.03241317265153239, -0.019599800452598376, 2.326115886503808),
            (-0.05148744221687412, 0.004436974855864945, 1.8010851008210134),
            (0.027915588824681953, 0.005590804290349555, 2.443574074068671),
            (0.06345761628291088, -0.0647466048681273, 2.1647327677309685),
            (0.05268525027239537, 0.07804371580509384, 1.7783788063334587),
            (0.07910168738094783, 0.003328360917286749, 2.4120551970722586),
            (-0.010177536381789615, -0.039613523696233215, 2.132357589129078),
            (-0.06704909319970254, 0.06237405928236148, 1.427097353340273),
            (0.03928840519719634, 0.02011600970374794, 1.571445028494761),
            (0.09743406076545921, -0.0855792757762906, 2.8384062470369917),
            (0.06062469225756481, -0.037225850896942414, 1.739000750036933),
            (-0.05815045843726736, 0.03498501469420667, 1.0933893761200082),
            (-0.04926570695040982, -0.026256821516556395, 1.2520775011747687),
            (0.05856271859556886, -0.07016976732827539, 2.1060505880074647),
            (-0.058552813217182975, -0.00942038403724832, 2.3431611922661153),
            (-0.030086652970079508, -0.01601230115981564, 2.494440802306494),
            (0.08595007371517821, -0.0974088156680433, 2.8428223092939806),
            (-0.049202397238500686, 0.018578310762485034, 1.5928890102649886),
            (0.019114796275393836, -0.07330654651809371, 2.3733637278717987),
            (0.0842238888819263, -0.07411208409662114, 2.8014396137902278),
            (0.0029489141569039035, 0.030091771048622096, 1.596297883876643),
            (-0.029614524668201733, 0.07491913890264748, 2.2703498561511477),
            (-0.006030016999773985, -0.0614944687249023, 1.1218146474377038),
            (0.0003356222841138373, 0.056342490176012755, 1.422740091944605),
            (-0.052360117393525044, 0.08947966938671795, 2.391664362472499),
            (0.01352671608285845, 0.03874457544405213, 1.5254198497601599),
            (-0.05417967823211187, -0.03330472675705909, 1.4358355928821196),
            (0.00801939478770683, 0.03730932165854206, 1.7172622970319604),
            (0.06617120897712311, -0.04831613223252014, 1.2243124283055524),
            (-0.026556513205548415, 0.07634226729209079, 1.457643920649107),
            (0.06794215466479472, 0.07042686271259677, 2.657163127809006),
            (0.029566530561727505, 0.00010713055826017115, 1.1294174683734046),
            (-0.07012465414430287, -0.022988915065674756, 1.0688864222533434),
            (-0.03467450973693671, 0.01777953494859555, 1.5421411939709941),
            (0.0699301146010275, -0.003527487202058935, 1.9208743268789414),
            (0.09009632114235397, 0.04552375958639637, 1.501378065550531),
            (0.0275054160146056, 0.0377060713137167, 1.8641739778712125),
            (0.03873605115383899, 0.02561202764602774, 1.814510655499464),
            (0.07087038541068433, 0.0716004249838808, 1.5953493007291564),
            (0.007757638493820274, -0.012244312428331308, 2.727637517676939),
            (0.033119333636841886, -0.011651902474569487, 1.792385511318203),
            (0.04009725417833948, 0.02508127391578019, 1.2593994974090807),
            (0.028897133006036024, -0.06003805893839287, 1.1166488009999544),
            (0.05353972200599347, -0.08404907337650583, 1.912235321342398),
            (0.037787818031563475, -0.030691358521126172, 2.3047359445897655),
            (0.09232395138179109, 0.04709476689532546, 1.5393587819283647),
            (-0.07230747031153362, 0.0013763502252173154, 2.1890480100248517),
            (-0.008146729991124493, -0.03147134058534787, 2.765754066599831),
            (0.06825120664615908, 0.01111421685833451, 2.298748892591263),
            (-0.047669094008427094, 0.026450781982516103, 2.9660882539128983),
            (-0.04586082699440852, -0.05570147038413562, 2.465061412529387),
            (-0.05588309721189651, -0.004898902305660105, 2.496597703496219),
            (-0.06048936990948639, -0.03710299407859728, 2.204279333104722),
            (-0.01778807827079376, -0.0540964251092676, 1.162812398082101),
            (-0.08354528961664826, 0.08695350070635863, 2.3915936791926695),
            (0.08277721796999007, 0.08806058202871511, 2.0478397281353917),
            (0.09111030758166652, -0.04972914752416294, 1.1333112556765663),
            (-0.06346158776962048, 0.08031439065526344, 1.2268634726707406),
            (0.09812896173250787, 0.041773648304205685, 2.4351850117257126),
            (-0.052981181328918964, 0.08381145510231033, 1.149718519649936),
            (-0.039476734149319716, -0.020297675060821405, 2.7786696948830363),
            (0.004403858705221447, 0.03239039598463153, 2.196075942000727),
            (-0.010128830840943112, 0.06548948573322663, 2.82801634368328),
            (0.09396759957841158, -0.002560651557156679, 1.9661714764595848),
            (-0.048876531399396676, -0.0536738130681574, 2.175927826441331),
            (-0.0908018250355913, 0.011553559056674836, 1.5131018001109136),
            (-0.09269169417830328, -0.021558550618883815, 2.0647593181009976),
            (-0.07628646203949906, -0.08482688784357412, 2.719915830851241),
            (0.08894270093111217, -0.03756501777177908, 2.576455082847545),
            (0.058305646870176225, 0.00708033706256142, 2.647058478590651),
            (-0.09170533096458829, 0.07015197339462495, 2.1994819000193617),
            (0.09983058784924143, -0.011022448529139722, 1.3999718464941795),
            (0.06564305330169504, 0.0545211743339481, 2.548998122104239),
            (0.09450002030092239, 0.008124471999009938, 1.6162279775516428),
            (0.08146132196142039, 0.028005296454098244, 2.661415894691513),
            (-0.07312797381903778, -0.061116603763264846, 1.9334217890345444),
            (-0.07831641184729916, 0.061453910791283234, 2.38680532676475),
            (0.07840492584265307, 0.0511453371721102, 1.1083468340964375),
            (-0.09258499305710635, -0.05906790839728626, 1.974318149395402),
            (-0.007443156304786008, 0.07668485959403368, 1.2428982019821875),
            (-0.032372345366346145, -0.012813233883810199, 2.9070684130500317),
            (-0.08107009685338039, 0.019863719172613342, 2.6750426873124598),
            (0.07463716859533984, -0.005085259172583664, 1.7713749471280482),
            (0.047713287656395625, 0.04073023781249002, 1.1434356299004904),
            (0.09329727665850338, -0.032557157411768886, 2.070641049323636),
            (0.03434345574140335, -0.034823766613068005, 2.88755643721705),
            (-0.08264338053009174, 0.03756714698200081, 2.8257747909353252),
            (-0.00896354947105718, -0.09268277329359571, 2.6203323096575284),
            (-0.008502399165356597, 0.025578511989947927, 2.8605347213055294),
            (-0.04117593526290993, 0.056954463688455, 2.0644763420657934),
            (-0.06884733527708434, 0.011116595281048025, 1.892397567230349),
            (-0.025358826958435984, 0.04384926439088013, 1.1209063166350919),
            (0.06905140406017074, -0.04303266471127285, 2.0218531548930945),
            (0.07682363459184433, 0.08577743419952319, 1.729079944737541),
            (0.07516222743754089, -0.05903929725330903, 2.9028121532281945),
            (-0.041334968484685014, 0.0474581388692249, 2.1790207350438484),
            (0.05247972552779115, 0.05628534512526595, 1.1894266043557205),
            (-0.0191412888758771, -0.09077715319906488, 2.0637010224661774),
            (0.030187363802607114, 0.06542653751004532, 1.9489267538657329),
            (0.06525736493913714, 0.06681524224791333, 1.1249261116866334),
            (0.014749086394629435, -0.027909552964150652, 1.0351241163563403),
            (-0.0672157292835523, -0.03203961228675463, 2.158505816185263),
            (-0.010237708475951554, 0.08483655851529581, 2.258048984357773),
            (-0.06751945006591928, -0.018802558697931238, 2.9108147841393897),
            (-0.017275628031748938, -0.07308678758933762, 1.5011430758653999),
            (-0.02650835275370056, 0.03371599784476298, 2.8546345758166884),
            (0.0322274480484529, 0.09317134645096989, 1.1161988286465756),
            (-0.04106372182009486, -0.02018593406963913, 2.069733513993164),
            (-0.09846331318075208, 0.09483246799439757, 2.3945907585991524),
            (-0.04879991053930406, -0.08790115754963189, 1.516976462698784),
            (-0.024687669944196758, 0.015724457192382205, 1.6198844069198601),
            (0.09501320954599354, -0.08690817302093407, 1.60858989937714),
            (0.0656596571962215, 0.07517130589935236, 1.389036388303981),
            (-0.03051072117341372, 0.06991694762288117, 2.9528164935424757),
            (-0.03163566170911418, 0.05589442418498078, 1.6771472431103205),
            (-0.015412382760800966, 0.02462265613956796, 2.4850078466991405),
            (0.009558556522593742, -0.002287514641239524, 1.6769395087424563),
            (-0.05650117877815517, -0.042083667396249094, 2.9385252707597904),
            (0.047738860967451585, 0.09657088814289064, 2.723038788125785),
            (-0.06594356346935598, 0.024600908159219115, 1.3842211372999422),
            (-0.051614560925127485, 0.048349867528259566, 2.138884481302877),
            (-0.07218770777889352, -0.06896661180517989, 1.9338804676506383),
            (-0.038378608476494394, -0.04443515964835039, 1.8982696198691),
            (-0.07708728374015744, 0.010925578095544036, 1.579736100120348),
            (0.06603844328220182, -0.016634229223936134, 1.035335893171458),
            (-0.0414587041373538, -0.07193550087094235, 2.1989703600184995),
            (0.08108685875558774, 0.010871928886419593, 1.2890230635997373),
            (-0.09517494648150333, -0.0025195955032040473, 1.368026373848024),
            (0.04931368259726471, 0.0188079767943429, 2.847610850119712),
            (-0.06533450464384294, -0.018560288652334583, 1.8272913384043072),
            (-0.053080738778374784, -0.04797382927080323, 2.996873561920223),
            (0.008630735750283017, -0.010346163197643449, 2.137505454114599),
            (-0.06893709482875737, 0.0913707065296939, 2.712111006637582),
            (-0.08759677772685813, 0.004884347637549968, 2.8772494168449176),
            (-0.07231409930999316, 0.037118985164582036, 1.8545212761733905),
            (0.004456421153319637, -0.03400767835078343, 1.2395991280424803),
            (-0.08627392713296081, 0.005062299734493528, 1.9936847634821593),
            (-0.060075309471247576, -0.05957455902062539, 2.786554283305609),
            (0.05251561249562245, -0.01979676113554822, 2.4240025449863896),
            (0.04976525230330678, -0.08379558210254573, 2.1358602964047777),
            (-0.0037719871894101448, 0.0991308080092344, 1.1115610880542661),
            (-0.04113558452626287, 0.07726159897358048, 1.0315301243889416),
            (0.0066565547498142336, 0.07027374787156743, 1.3224073246156476),
            (0.022620814298301428, -0.05526030646719289, 2.0625395748737403),
            (0.05220900933057124, -0.015191876969337964, 1.1265885684970356),
            (0.060131568921187595, -0.06538089516234682, 1.0297643686219184),
            (-0.00721188804095578, 0.020407766314973805, 1.1823534327695553),
            (-0.05481316774763909, 0.05429549861239871, 2.4078558042619576),
            (0.0005161550034898515, -0.003960677010403674, 2.967961121604055),
            (0.0347509281282988, 0.05808007662587114, 2.188792178478713),
            (0.018647165782187752, -0.04410920782531718, 1.7673284790104065),
            (0.08564715088658931, -0.01574947171936332, 2.91178202454),
            (-0.018750700512624577, 0.07731495951657674, 1.109395376715096),
            (0.05405934534483067, 0.07807356388896922, 1.231542302104227),
            (-0.061069388063150126, 0.010530441882752622, 1.4081553472528139),
            (0.02501227517692267, -0.08115274942708589, 1.0258299277468588),
            (0.06586137749763721, -0.07229148742449093, 2.569690859335763),
            (0.015803415084836153, -0.0366181002489943, 1.987981380782886),
            (-0.040092919001114426, -0.06901035254316693, 1.2801151698942284),
            (-0.07498570456601897, 0.036476478528990025, 2.762762352000939),
            (-0.01704806051734939, -0.09241127653344727, 2.259325695091512),
            (-0.08118774763876412, -0.011871667826435117, 1.2441272972527795),
            (0.009902984167056442, 0.05732537295951545, 1.9664631551939198),
            (0.030623286144565387, 0.09651087311803452, 1.8108463753954591),
            (-0.06289182143477312, 0.08729120904272392, 2.6929731430243447),
            (-0.059574518183831505, 0.02952732502953695, 2.8079724275617983),
            (-0.015376959288824169, -0.011887203512044572, 2.031460936055919),
            (0.027152167317329584, 0.07311353489938596, 1.7254613024951508),
            (0.06494769247376472, 0.007535785302498349, 1.0976760260918603),
            (-0.0941947986833695, 0.09935907376897898, 1.4136668583440275),
            (-0.05073245471115906, -0.08714474153715415, 1.5658654650491128),
            (-0.04602041281874541, 0.00820722398772647, 1.2516889622521545),
            (-0.07321287641817838, 0.03972096256839125, 2.9834273641451086),
            (-0.04208075605801847, -0.0713330278786074, 1.1306751787821039),
            (0.08080247958613263, -0.09981648682846654, 2.261176416604044),
            (-0.013785396729588006, -0.04318715085936467, 2.3297949257143404),
            (0.03756861597634514, 0.01013996672234481, 2.538409915038735),
            (0.04238499465223508, 0.0753454037852353, 2.3459719154458627),
            (-0.02293022921400474, -0.027499104597352345, 2.669550506117754),
            (-0.07378733491550973, -0.023412186029119722, 2.9175023886235136),
            (0.004586755086596603, 0.026920843363926472, 2.0986095090078587),
            (-0.0273410206731928, -0.04147034359929274, 1.7988738926468217),
            (-0.030197338969768325, -0.02668911101537022, 1.1476379604301221),
            (0.029478313111461818, -0.07930286468442219, 1.8993752416621386),
            (0.0052399072891371745, -0.03815772456292053, 2.7290736287968596),
            (-0.017770943128366384, 0.018907439431219267, 2.8230128743799145)],
 'work': [(0.08545240061940507, 0.048640251887508756, 1.1005454543000743),
          (0.12432090946162684, -0.027645067086974034, 1.5089182830856378),
          (0.12517913594211338, -0.033176124784006916, 2.164741157825473),
          (0.11430967804699706, 0.0782277374628986, 1.195709230417807),
          (0.13332288068646037, -0.056048010662782845, 1.0513928616854114),
          (0.06929455723577257, -0.06723521432074782, 1.0811003090600613),
          (0.11264183710614867, -0.04587523979957567, 2.1277676683017734),
          (0.11512433372307097, 0.051207370789394746, 2.893917012195999),
          (0.06592632729112631, 0.01598800897225154, 1.7498429908809348),
          (0.05642367722216077, -0.04251851481401634, 1.0075643605415647),
          (0.054462529456520574, -0.04892615619959864, 2.7468189198143182),
          (0.10294402930162586, 0.05449999635011024, 2.666881811402633),
          (0.09407676959348055, -0.030195004951240376, 1.5211068537242864),
          (0.11528356737399566, -0.00718586644734906, 2.8662866048037854),
          (0.06150349155762367, 0.044492945129124356, 2.4794750789605517),
          (0.13122301924178525, 0.026448491757029985, 2.047022795396164),
          (0.10160102393075188, 0.031025819186098202, 1.4450147283509387),
          (0.08980399223853563, -0.0928003776192533, 1.7465713534442249),
          (0.07314086738855938, 0.06985834932768015, 2.19687829756933),
          (0.06878125381227672, -0.050320374851887895, 2.296942552412994),
          (0.13954275133920957, -0.06746318516086583, 2.811726299180817),
          (0.05254862557413445, -0.03053022271921378, 2.389897550930804),
          (0.1016309766867225, 0.04498360070897264, 2.40729702150594),
          (0.13039806387277741, -0.09525226295969723, 1.967500418417498),
          (0.13144190148670848, -0.009144808097183516, 2.158772848281459),
          (0.1448380731848394, 0.09136394832798495, 2.485620972851267),
          (0.13761066079257228, -0.04515077830199639, 1.428087296670945),
          (0.13329671392358816, -0.018315126635214868, 2.3918034208126517),
          (0.0869551075244548, -0.011517883898415723, 1.942601786757636),
          (0.12311683569400612, -0.038340952397386774, 1.1506794150558763),
          (0.12939538048313892, 0.05173729441172603, 1.7742379488470392),
          (0.060620861751832705, -0.05212079804195238, 1.488290867337497),
          (0.07769637454793768, 0.05516865380325506, 2.336921295456277),
          (0.14086817883303804, -0.013951346485298124, 2.1705537063928695),
          (0.09432363843523828, 0.04996087896248416, 1.416159339458644),
          (0.1351530759997245, 0.06171853678981162, 1.0793632006565155),
          (0.06362077532208948, -0.011614555456449668, 1.6555123773367186),
          (0.13056611098365917, 0.07360298317588496, 2.385687265611026),
          (0.07811459738395245, 0.02746759819170458, 2.2387921690683505),
          (0.051431085799308544, -0.07063874749580151, 1.2482305079342793),
          (0.13850288818075415, 0.012083299106858902, 1.2466487746967616),
          (0.05794273050241488, 0.024786913934592647, 1.2423553513250696),
          (0.14177630953283576, -0.0825395976844559, 1.1676521783012572),
          (0.09271684541925485, -0.03573986508198157, 1.9849857702970495),
          (0.10474983612222111, -0.06878480109143909, 2.1923033923476245),
          (0.13942282941264467, 0.055148465705750355, 2.6628195241958332),
          (0.14982920932690075, -0.07048100984439708, 1.339334518967913),
          (0.13220619228239172, -0.0842544079402265, 2.417302181214678),
          (0.14138780617430916, 0.05956182684892977, 2.4065672382618075),
          (0.05135966498878996, -0.01922828757713524, 1.697580153877482),
          (0.07042091935196797, -0.00908679605443892, 1.20106741306041),
          (0.12861747632215725, -0.04926272751950267, 1.6294140846481655),
          (0.10257717972791261, -0.08289900523751392, 2.7511119664007877),
          (0.14116965275298443, 0.050227574498549366, 1.6145228505154283),
          (0.13464200409379795, -0.05934310221397732, 1.9522674735551067),
          (0.07685783110573544, -0.02292557192261699, 1.8376308080749884),
          (0.12305513047868517, 0.041287899058526645, 1.9739133920429976),
          (0.1314895999446901, -0.0653476628726333, 2.7238658886991747),
          (0.13154743747586056, 0.04112432105966915, 1.6794261338789944),
          (0.10904170186064008, -0.0755984404772169, 2.122304816699713),
          (0.0952545158331165, -0.08634246758133679, 2.7314573125703685),
          (0.1234153327396851, 0.028777859962294206, 2.3255102962752394),
          (0.12459060969729252, 0.026872427540097055, 1.6309712452162222),
          (0.09033988979669769, -0.06034043158854052, 1.3362785905079981),
          (0.08665964076560725, -0.09230708527843333, 1.545109711350947),
          (0.08257193031381767, 0.06440557273952621, 2.8423136644561398),
          (0.11984585620102717, -0.02623440470364928, 1.4513086718088117),
          (0.12760610063679584, -0.00684121469305729, 2.863567206585319),
          (0.06637512009787618, -0.022493523992843906, 2.85383987940233),
          (0.06650288878280872, -0.09346748668353395, 2.574495279521246),
          (0.06802634569763731, 0.05834424165148114, 1.6908833599854964),
          (0.14059725661487268, -0.01805157728526599, 2.701007404626462),
          (0.08019058248292385, 0.097086962739133, 2.240223112792971),
          (0.10100598144188486, -0.04271829797723841, 1.720642459248574),
          (0.12316721713431153, 0.03530394128121636, 1.1449607595467737),
          (0.07664201558368446, 0.0924086649566222, 1.3895716206540576),
          (0.05196297129332888, -0.04457165617705412, 1.7959442920271025),
          (0.07133047350256291, -0.0279486832279843, 1.3917712728933205),
          (0.08386034873572154, -0.09110012497041123, 2.531740524125393),
          (0.07163051860596595, -0.03972649077864035, 2.2857067150483523),
          (0.05713450376068338, 0.001493667628915868, 2.1144185799695716),
          (0.07117325222470056, -0.06244654843670619, 1.5891903935657357),
          (0.09253346226234607, 0.044988753375974716, 2.2268584300161653),
          (0.06478725629638259, -0.04252264122309493, 2.642865269743488),
          (0.08604835809829633, -0.09373995244239369, 1.4939049536647506),
          (0.07157958500020346, 0.008057727249811866, 1.2527489699621794),
          (0.14562808633624158, -0.003518460479653568, 1.1920347485143297),
          (0.1394557471631664, -0.040602686750093, 2.4474101824203167),
          (0.0960217033765821, -0.0007532779830393271, 1.3396454039990433),
          (0.09154806829291726, 0.09156794870980065, 2.0279440515171294),
          (0.05255503026993268, 0.06109986059165093, 1.5854050860931692),
          (0.0739010795645705, -0.06034602631761346, 2.2326009204251838),
          (0.0674537578570428, 0.06283034176108401, 1.1727261639982762),
          (0.1466255812074817, 0.00669283405679863, 1.8632044763503541),
          (0.14056929163647552, 0.010694517083850247, 2.781385424631825),
          (0.14058567015257878, -0.018694669355856217, 1.9682696595013744),
          (0.0813539176524476, 0.04635521526624373, 1.3082226688055132),
          (0.14552441054842924, 0.016209859450898256, 2.0227327872366714),
          (0.10207272493905582, 0.05181189077917042, 2.056224502953162),
          (0.1370820577794233, 0.0800253959445636, 2.8646991271248856),
          (0.1275356083430338, -0.08041978935349287, 1.41469995375424),
          (0.07273261867376261, -0.02548254882106582, 2.9347937174107313),
          (0.12168590764466336, -0.022679314636834966, 2.838110332024467),
          (0.06802803610375403, -0.00598183778670347, 1.1110218372483327),
          (0.1324493467479074, 0.07401429643524163, 2.4919938128117627),
          (0.13160483586487065, -0.0513154499732081, 2.7056939533115933),
          (0.09122926970372577, 0.06678609189400217, 2.591245874920852),
          (0.1311681737050686, -0.09635679973835663, 1.0886799714613635),
          (0.11043927480799279, -0.020103764571863497, 2.178448271880594),
          (0.09704217919822383, -0.04590377499223222, 2.545164880364135),
          (0.08727867949318549, -0.09305915405687384, 1.0827491551481512),
          (0.09009542881494455, -0.019950417910845356, 2.2696501077374327),
          (0.13960972583782805, 0.08701844867334477, 2.7127028136545053),
          (0.0712756980865212, -0.040489254924848006, 2.8665759595705818),
          (0.0962954148943812, -0.04007558197932766, 2.659153485505839),
          (0.09315856962336143, 0.013249024310879529, 1.8630736815758326),
          (0.09622350641277465, -0.008031541643062717, 2.3647432737289087),
          (0.06347588188686887, 0.06763213307964194, 2.7204041435429875),
          (0.07238667737661032, 0.06067846537958446, 1.8195059294614093),
          (0.1481730439229092, -0.06280051113230883, 1.5029700821166396),
          (0.07457385926903708, 0.021822246685850866, 1.3618914143266494),
          (0.08758416122540823, -0.07445870932988854, 2.415404672768794),
          (0.07057896896872874, 0.07051549813486302, 2.1583126899222744),
          (0.1421755801468655, -0.09055188125315645, 1.3935018062836415),
          (0.1166682145315536, -0.016458943066797044, 2.007268227024743),
          (0.1378406785799698, -0.05760986799421291, 1.0526124828286687),
          (0.09077112164860093, 0.021740704124259408, 1.079549060231693),
          (0.13070204691072124, -0.030501316143283067, 1.0314028922291651),
          (0.10771068453749794, -0.04122333777973489, 1.9312154356376292),
          (0.14403384023736446, -0.07644502395415767, 1.709072113037914),
          (0.10548958657083204, 0.03927066139777444, 2.151794025933848),
          (0.1096053463461947, -0.07890715342132998, 2.885876441361844),
          (0.09780717882613436, 0.08587350776640287, 2.16442028297282),
          (0.08549510740556063, -0.09730300150779075, 1.2128469536793827),
          (0.10638979081441183, -0.08403610127582312, 2.361292811101119),
          (0.09381217723327726, -0.0211564396863045, 2.541807258018634),
          (0.06622669468205122, 0.022381593877378522, 1.416601704250393),
          (0.10552313251333542, -0.0511084789687315, 2.9299765328224243),
          (0.149681885651329, 0.08098729426821302, 1.1347306213543973),
          (0.07131188497819932, -0.03974832783673954, 2.1953553373759105),
          (0.11394681769297021, 0.05790913875069337, 1.9993278598381727),
          (0.1492877803083063, 0.013146003142591442, 2.4254567992272915),
          (0.0813707040709796, -0.029175278887755826, 2.546708690170529),
          (0.10220637819763753, 0.03728495232088011, 2.151021830682435),
          (0.14765951502790325, -0.04882040577522517, 2.580793980304457),
          (0.08485953552753735, -0.006666997081664211, 2.012514558643367),
          (0.08389978373378025, 0.05122683175055093, 1.608964640233154),
          (0.13598327625875076, -0.07880927172891233, 2.4349726424593037),
          (0.12151999185272558, 0.027921441435624944, 2.6028095518911636),
          (0.10653866442268689, -0.09613558125316915, 1.3909503939408285),
          (0.1031602385639635, -0.015388631245885631, 2.7699572419413565),
          (0.1453879936604207, 0.05877505655240814, 1.478578753751371),
          (0.06440374873633212, -0.027241134445219015, 1.1145150828009758),
          (0.1452000447846361, -0.020862951912277744, 2.7055045244377904),
          (0.12804057567703434, 0.05399195273055615, 2.850658734961688),
          (0.08557066226190241, -0.04190591464215501, 2.4541112447941194),
          (0.09697623670704142, -0.08047407835531457, 2.3556103863077897),
          (0.08149012766014188, 0.0336331785301317, 2.367489032838073),
          (0.06324867643490673, -0.028425499081039127, 1.639727089405059),
          (0.09495509380221938, -0.03035819000630667, 1.634619139010897),
          (0.0860729013095523, 0.05475271708658322, 2.1664062373862873),
          (0.10768036797423794, -0.08626026938183079, 1.7820514659007798),
          (0.08436519475896952, -0.046158101253663264, 1.0916119793344892),
          (0.1343497140442227, 0.06289040839299484, 2.9414362012092843),
          (0.14899368510405647, 0.0342179183837005, 1.0738273327532848),
          (0.0832638335657664, 0.055071045760130666, 1.985286606426508),
          (0.09516594521037285, 0.008902565477112476, 1.0725459931099741),
          (0.09883956553423903, -0.037567421001268336, 2.3144275443719295),
          (0.11304647975712769, 0.05869314179569424, 2.352307130570484),
          (0.05171600261671766, -0.029588822662269837, 1.398409327040824),
          (0.08498046624495628, 0.038037770593676634, 1.2024699002945973),
          (0.11858311312474569, 0.07824597306838837, 1.1101395122736462),
          (0.06630292563225565, 0.04832642279186594, 2.0536689617193797),
          (0.0835003141788866, 0.026037293551255003, 2.0073273686125965),
          (0.0705767623131858, -0.04896691280014516, 1.1195754015501713),
          (0.11292033826156021, 0.09215462717649697, 1.704777702121102),
          (0.07696829750120973, -0.00039231053958391215, 2.121190263982898),
          (0.07974780006518159, -0.0733256603702634, 1.4290764829094469),
          (0.07953157219462209, -0.04602692502576509, 2.086065681173655),
          (0.05865542437369449, 0.03646404317372087, 2.99930085473165),
          (0.12901030593015939, 0.013931583449079826, 1.3053828389812525),
          (0.0758775478941948, 0.03567779017110248, 2.536607326472297),
          (0.08353842472770086, 0.06408641880684293, 2.3676336906307522),
          (0.13132710431931677, -0.03031270173537748, 1.3384717522935283),
          (0.1419896935725642, 0.0211773667963491, 2.8375119527572084),
          (0.08952503688065472, -0.03146524465382823, 2.3667436928511787),
          (0.07802784842362435, -0.013111517346777596, 2.3846172784159414),
          (0.05423020615542872, 0.0695520511114168, 2.833151958965397),
          (0.11835796564023324, 0.08735424681360521, 1.2226150332218135),
          (0.07060068941764015, 0.043991228912640734, 1.5450026378484074),
          (0.10564306168590923, 0.0038896415212544555, 2.1913227115368685),
          (0.13247113567161956, -0.020240801996319904, 2.045007731456127),
          (0.10396923462090883, -0.04244118770833547, 2.5604901808680225),
          (0.1316768044379903, -0.06822940867966731, 2.1731659239196155),
          (0.07575384828200102, 0.07231445564022335, 2.865815002753072),
          (0.05740491287421015, -0.08365270903171139, 1.0618352123449046),
          (0.12595557587745965, -0.01875923694189552, 1.3239365872395776),
          (0.14377620995322524, -0.07643694936542778, 1.6894752591725013),
          (0.06105194789957128, 0.026002986492235258, 1.5996384580217484),
          (0.10329554881181491, -0.019512488796351327, 1.7215823813207023),
          (0.08018900659474865, -0.01358590606491386, 2.7590659083317357),
          (0.0677458008376993, 0.08464359730818158, 2.957903364871188),
          (0.054056343083758895, -0.09707731454834188, 1.0927167764527306),
          (0.07526433577133121, 0.08381476988826517, 1.7753253580971227),
          (0.09458940880426187, -0.051558925639718534, 2.7600329163309882),
          (0.05958047289602067, 0.020270962181139413, 1.3662959225473845),
          (0.0762340946338996, 0.09337150335405944, 2.3310712332607473),
          (0.10240807437927626, -0.0008636087755258676, 1.5348481909630007),
          (0.06623720228467744, -0.09365933204927175, 2.3261823754668782),
          (0.05834674647157143, -0.06868665501541849, 2.136485894825197),
          (0.08451342148948994, 0.008075892280458644, 2.330343675302897),
          (0.07388080699832646, -0.06898259472269748, 1.2712420663720263),
          (0.1355930598770137, 0.017838650776793738, 1.2658523962762775),
          (0.13928938612150937, -0.09731731583468668, 1.149699821461849),
          (0.11343765908548321, 0.0198685793148341, 1.7915662792001275),
          (0.112193680027041, -0.0488992523830456, 1.382311505455239),
          (0.11687018167406811, 0.09030136101782785, 1.460402162994167),
          (0.06076085872402584, 0.030047530330384292, 2.018732330937177),
          (0.06345438176928694, -0.020254271819822603, 1.4024300388393165),
          (0.13413679018263222, 0.004868054784979606, 2.1218183901616556),
          (0.07249479881596457, -0.029601456706499385, 2.726935062627466),
          (0.09245774193071392, -0.006993144967937598, 1.226559696270362),
          (0.06499997659180522, 0.01934956171773572, 2.510175289234439),
          (0.064890890891313, 0.044994716983231486, 2.6337302232796507),
          (0.11707678886002706, 0.07309746776973522, 1.325191528387603),
          (0.1120242327602492, -0.09696848494395015, 2.141515499378766),
          (0.05949475197283621, 0.033350340587947336, 1.2776206202491194),
          (0.05072263799405832, -0.028654462101434117, 2.423061716901713),
          (0.09532864542616737, 0.07147948223740394, 2.010721130258181),
          (0.09575273802055317, -0.08511417120631055, 2.2312548958545504),
          (0.13719651413582432, -0.09567001291238274, 2.984436228633375),
          (0.06944454368741813, 0.06397553361481267, 2.9119275778222224),
          (0.050381475108376234, -0.03491064308945839, 2.0177064339777364),
          (0.1281733340772097, -0.03668858068548368, 2.8061815978497053),
          (0.09842365383035998, 0.0035652250995954204, 2.901068051841813),
          (0.05617817796458977, 0.036877208457319954, 1.1110108935447087),
          (0.08786549970933451, 0.08933596494866733, 1.84024532535528),
          (0.06045795182755026, 0.05704934708419146, 1.8361281491111607),
          (0.05704060740259799, -0.03894654124524777, 2.6720095561606225),
          (0.06663633480115647, -0.032408090864347025, 1.2464195222883132),
          (0.1119352354571348, -0.06967171257881606, 2.8401931530727316),
          (0.11243621012694692, 0.0008240306803624364, 1.2748048631267495),
          (0.10146780626055923, -0.0863036532220207, 2.831176239365884),
          (0.12035821459076876, 0.049218091480410175, 2.7005106475228944),
          (0.1336473165669086, 0.04449778746053934, 2.2029573303947663),
          (0.09190637224618235, -0.07468709896391244, 1.480852633239784),
          (0.06688757788519498, 0.05600766003332078, 2.0188152351212074),
          (0.07897086107346347, -0.01826526639936696, 1.561480104009909),
          (0.11087313345230587, 0.09038936610478726, 2.4988692152623657),
          (0.07606206194618259, 0.06600714670986171, 1.864433749177142),
          (0.07553410942304796, 0.046390400507904744, 2.9567831718924014),
          (0.1224712615061163, 0.048285919913643977, 1.1951844421669606),
          (0.07828613650563224, -0.08071657703473345, 1.901787032421561),
          (0.06949496029157085, 0.06950340008200881, 1.2849219610019604),
          (0.05614706246750423, 0.0010169928990525906, 1.387886581542789),
          (0.0967766266950646, 0.06583950506538117, 2.528725168752782)]}

main()

# Comment to update:672344886463130360